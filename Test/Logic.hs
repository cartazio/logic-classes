{-# LANGUAGE FlexibleContexts, FlexibleInstances, MultiParamTypeClasses, OverloadedStrings,
             TypeSynonymInstances, UndecidableInstances #-}
{-# OPTIONS -Wall -Wwarn -fno-warn-name-shadowing -fno-warn-orphans #-}
module Test.Logic (tests) where

import qualified Chiou.FirstOrderLogic as C
import Control.Monad.Identity (Identity(..), runIdentity)
import Control.Monad.State (MonadState(..), StateT, evalStateT)
--import Data.List (intercalate)
import qualified Data.Set as Set
import Data.String (IsString(fromString))
import qualified Logic.Instances.Parameterized as P
import Logic.Instances.Chiou (AtomicFunction(..))
import Logic.Instances.PropLogic (flatten)
import Logic.Logic (Logic(..))
import Logic.NormalForm (prenexNormalForm, skolemNormalForm, disjunctiveNormalForm, cnf)
import Logic.Predicate (Skolem(..), PredicateLogic(..), InfixPred(..), toPropositional, showForm, freeVars, substitute)
import Logic.Satisfiable (clauses, theorem, inconsistant)
import PropLogic (PropForm(..), truthTable)
import qualified TextDisplay as TD
import Test.HUnit

instance Show (P.Formula String String) where
    show = showForm

type TestFormula = C.Sentence -- TestFormula
type TestTerm = C.Term -- P.Term String
--type TestFormula = P.Formula String String
--type TestTerm = P.Term String

--type TestVariable = String
--type TestPredicate = String

tests :: [Test]
tests = precTests ++ cnfTests ++ theoremTests

formCase :: PredicateLogic (P.Formula String String) (P.Term String) P.V String String =>
            String -> TestFormula -> TestFormula -> Test
formCase s expected input = TestCase (assertEqual s expected input)

formCaseChiou :: PredicateLogic C.Sentence C.Term String String AtomicFunction =>
                 String -> TestFormula -> TestFormula -> Test
formCaseChiou s expected input = TestCase (assertEqual s expected input)

precTests :: [Test]
precTests =
    [ formCase "prec test 1"
               -- Note that the result of cnf is a conjunction of disjunctions, which
               -- will not group properly without parentheses.
               ((a .&. b) .|. c)
               (a .&. b .|. c)
      -- You can't apply .~. without parens:
      -- :type (.~. a)   -> (FormulaPF -> t) -> t
      -- :type ((.~.) a) -> FormulaPF
    , formCase "prec test 2"
               (((.~.) a) .&. b)
               ((.~.) a .&. b)
    -- I switched the precedence of .&. and .|. from infixl to infixr to get
    -- some of the test cases to match the answers given on the miami.edu site,
    -- but maybe I should switch them back and adjust the answer given in the
    -- test case.
    , formCase "prec test 3"
               ((a .&. b) .&. c) -- infixl, with infixr we get (a .&. (b .&. c))
               (a .&. b .&. c)
    , TestCase (assertEqual "Find a free variable"
                (freeVars (for_all [x'] (x .=. y) :: TestFormula))
                (Set.singleton y'))
    , TestCase (assertEqual "Substitute a variable"
                (map sub
                         [ for_all [x'] (x .=. y) {- :: Formula String String -}
                         , for_all [y'] (x .=. y) {- :: Formula String String -} ])
                [ for_all [x'] (x .=. z) :: TestFormula
                , for_all [y'] (z .=. y) :: TestFormula ])
    ]
    where
      sub f = substitute (head . Set.toList . freeVars $ f) (var "z") f
      a = pApp ("a") []
      b = pApp ("b") []
      c = pApp ("c") []

cnfTests :: [Test]
cnfTests = concatMap pairTest testFormulas ++
           [test1, test2, test3, test4, test5, test6, test7, test8, test9, test10, test11, test12, test9a,
            moveQuantifiersOut1, skolemize1, skolemize2, skolemize3]

p :: (IsString t, PredicateLogic formula term v t f) => [term] -> formula
p vs = pApp "p" vs
q :: (IsString t, PredicateLogic formula term v t f) => [term] -> formula
q vs = pApp "q" vs
r :: (IsString t, PredicateLogic formula term v t f) => [term] -> formula
r vs = pApp "r" vs
s :: (IsString t, PredicateLogic formula term v t f) => [term] -> formula
s vs = pApp "s" vs
x' :: IsString v => v
x' = "x"
y' :: IsString v => v
y' = "y"
z' :: IsString v => v
z' = "z"
u' :: IsString v => v
u' = "u"
v' :: IsString v => v
v' = "v"
w' :: IsString v => v
w' = "w"
x :: (PredicateLogic formula term v p f, IsString v) => term
x = var (fromString "x")
y :: (PredicateLogic formula term v p f, IsString v) => term
y = var (fromString "y")
z :: (PredicateLogic formula term v p f, IsString v) => term
z = var (fromString "z")
u :: (PredicateLogic formula term v p f, IsString v) => term
u = var (fromString "u")
v :: (PredicateLogic formula term v p f, IsString v) => term
v = var (fromString "v")
w :: (PredicateLogic formula term v p f, IsString v) => term
w = var (fromString "w")

-- Test cases from http://www.cs.miami.edu/~geoff/Courses/CS63S-09S/Content/FOFToCNF.shtml

type SkolemT = StateT Int

instance IsString f => Skolem (StateT Int Identity) f where
    skolem = get >>= \ n -> put (succ n) >> return (fromString (show n))
{-
instance Skolem (SkolemT Identity) String where
    skolem = get >>= \ n -> put (succ n) >> return (fromString (show n))
-}

cnf' :: (IsString f, PredicateLogic formula term v p f, Eq formula, Eq term, Show formula) => formula -> formula
cnf' f = runIdentity (evalStateT (cnf f) 1)
--cnf' _f = runIdentity (evalStateT undefined 1)

snf' :: TestFormula -> TestFormula
snf' f = runIdentity (evalStateT (skolemNormalForm f :: SkolemT Identity (TestFormula)) 1)
--snf' _f = runIdentity (evalStateT undefined 1)

theorem' :: TestFormula -> Bool
theorem' f = runIdentity (evalStateT (theorem f :: SkolemT Identity Bool) 1)
--theorem' _f = runIdentity (evalStateT undefined 1)

inconsistant' :: TestFormula -> Bool
inconsistant' f = runIdentity (evalStateT (inconsistant f :: SkolemT Identity Bool) 1)
--inconsistant' _f = runIdentity (evalStateT undefined 1)

table' :: TestFormula -> [String]
table' f = runIdentity (evalStateT (table f :: SkolemT Identity [String]) 1)

testFormulas :: [(String, TestFormula, TestFormula)]
testFormulas =
    [("cnf test 1", f1, (cnf' f2))]
    where
      f1 :: TestFormula
      f1 = ((((.~.) (taller y xy)) .|. (wise y)) .&. ((.~.) (wise xy) .|. (wise y)) :: TestFormula)
      f2 :: TestFormula
      f2 = (for_all [y'] (for_all [x'] (taller y x .|. wise x) .=>. wise y))
      -- cf :: SkolemT Identity (Formula String String)
      -- cf = cnf (for_all [y'] (for_all [x'] (taller y x .|. wise x) .=>. wise y))
      xy :: TestTerm
      xy = fApp (fromString "1") [var (fromString "y")]
      y :: TestTerm
      y = var "y"
      taller :: TestTerm -> TestTerm -> TestFormula
      taller a b = pApp "taller" [a, b]
      wise :: TestTerm -> TestFormula
      wise a = pApp "wise" [a]

pairTest :: (String, TestFormula, TestFormula) -> [Test]
pairTest (s, f1, f2) =
    [ TestCase (assertEqual (s ++ ", Chiou to cnf") f1 f2) ]

test1 :: Test
test1 =
    TestCase (assertEqual "cnf test 1" f1 (cnf' f2))
        where
          f1 :: TestFormula
          f1 = ((((.~.) (taller (y :: TestTerm) xy)) .|. (wise y)) .&. ((.~.) (wise xy) .|. (wise y)))
          f2 :: TestFormula
          f2 = (for_all [y'] (for_all [x'] (taller y x .|. wise x) .=>. wise y)) 
          -- cf :: SkolemT Identity (TestFormula)
          -- cf = cnf (for_all [y'] (for_all [x'] (taller y x .|. wise x) .=>. wise y))
          xy = fApp (fromString "1") [y]
          taller :: TestTerm -> TestTerm -> TestFormula
          taller a b = pApp "taller" [a, b]
          wise :: TestTerm -> TestFormula
          wise a = pApp "wise" [a]

test2 :: Test
test2 = formCase "cnf test 2"
                 (((.~.) (pApp "s" [x])) .|. ((.~.) (pApp "q" [x]))) 
                 (cnf' ((.~.) (exists [x'] (pApp "s" [x] .&. pApp "q" [x]))))
                  
test3 :: Test
test3 = formCase "cnf test 3"
                  (((.~.) (p [x])) .|. ((q [x]) .|. (r [x])))
                  (cnf' (for_all [x'] (p [x] .=>. (q [x] .|. r [x]))))

test4 :: Test
test4 = formCase "cnf test 4"
                  (p [x] .&. (.~.) (q [y]))
                  (cnf' ((.~.) (exists [x'] (p [x] .=>. exists [x'] (q [x])))))

test5 :: Test
test5 = formCase "cnf test 5"
                  ((((.~.) (q [x])) .|. s [x]) .&. (((.~.) (r [x])) .|. s [x]))
                  (cnf' (for_all [x'] (q [x] .|. r [x] .=>. s [x])))

test6 :: Test
test6 = formCase "cnf test 6"
                  ((.~.) p .|. f skX)
                  (cnf' (exists [x'] (p .=>. f x)))
    where
      skX = fApp "1" []
      f x = pApp "f" [x]
      p = pApp "p" []

test7 :: Test
test7 = formCase "cnf test 7"
                  -- This is what was given by the source
                  -- (((.~.) p) .|. f skX .&. p .|. ((.~.) (f skX)))
                  -- This is what we are currently getting from our
                  -- code, which is different but still may be correct.  However, we may
                  ((((.~.) p) .|. (f skX)) .&. (((.~.) (f skX)) .|. p))
                  -- (((p []) .|. (p [])) .&. ((((.~.) (f [x])) .|. ((.~.) (f [x]))) .|. (p [])))
                  -- p
                  (cnf' (exists [x'] (p .<=>. f x)))
    where
      skX = fApp "1" []
      f x = pApp "f" [x]
      p = pApp "p" []

test8 :: Test
test8 = formCase "cnf test 8"
                 expected
                 (cnf' f2)
    where
      expected :: TestFormula
      expected = (((((.~.) (f [x, yOfZ])) .|. (f [x, z])) .&.
                   (((.~.) (f [x, yOfZ])) .|. ((.~.) (f [x, x])))) .&.
                  ((((.~.) (f [x, z])) .|. (f [x, x])) .|. (f [x, yOfZ])))
      f2 :: TestFormula
      f2 = (for_all [z'] (exists [y'] (for_all [x'] (f [x, y] .<=>. (f [x, z] .&. ((.~.) (f [x, x])))))))
      -- (x', y', z') = (P.V "x", P.V "y", P.V "z")
      -- (x, y, z) = (var x', var y', var z')
      yOfZ = fApp "1" [z]
      f vs = pApp "f" vs

test9 :: Test
test9 =
    formCase "cnf test 9"
             (((((.~.) (q [x,y])) .|. ((((.~.) (f [z,x])) .|. ((f [z,y]))))) .&.
               ((((.~.) (q [x,y])) .|. ((((.~.) (f [z,y])) .|. ((f [z,x]))))))) .&.
              ((((((f [fApp ("1") [x,y,z],x]) .|. ((f [fApp ("1") [x,y,z],y]))) .|. ((q [x,y]))) .&.
                 (((((.~.) (f [fApp ("1") [x,y,z],y])) .|. ((f [fApp ("1") [x,y,z],y]))) .|. ((q [x,y]))))) .&.
                (((((f [fApp ("1") [x,y,z],x]) .|. (((.~.) (f [fApp ("1") [x,y,z],x])))) .|. ((q [x,y]))) .&.
                  (((((.~.) (f [fApp ("1") [x,y,z],y])) .|. (((.~.) (f [fApp ("1") [x,y,z],x])))) .|. ((q [x,y])))))))))
             (cnf' (for_all [x'] (for_all [y'] (q [x, y] .<=>. for_all [z'] (f [z, x] .<=>. f [z, y])))))
    where
      f = pApp "f"
      q = pApp "q"
      -- skZ = fApp "Sk(z)"
      -- (x', y', z') = (P.V "x", P.V "y", P.V "z")
      -- (x, y, z) = (var x', var y', var z')

-- |Here is an example of automatic conversion from a PredicateLogic
-- instance to a PropositionalLogic instance.  The result is PropForm
-- a where a is the original type, but the a values will always be
-- "atomic" formulas, never the operators which can be converted into
-- the corresponding operator of a PropositionalLogic instance.
test9a :: Test
test9a = TestCase 
           (assertEqual "convert to PropLogic"
            expected
            (flatten (toPropositional convertA (cnf' (for_all [x'] (for_all [y'] (q [x, y] .<=>. for_all [z'] (f [z, x] .<=>. f [z, y]))))))))
    where
      f = pApp "f"
      q = pApp "q"
      convertA = A
      expected :: PropForm TestFormula
      expected = (CJ [DJ [N (A (q [x,y])),N (A (f [z,x])),A (f [z,y])],
                      DJ [N (A (q [x,y])),N (A (f [z,y])),A (f [z,x])],
                      DJ [A (f [fApp "1" [x,y,z],x]),A (f [fApp "1" [x,y,z],y]),A (q [x,y])],
                      DJ [N (A (f [fApp "1" [x,y,z],y])),A (f [fApp "1" [x,y,z],y]),A (q [x,y])],
                      DJ [A (f [fApp "1" [x,y,z],x]),N (A (f [fApp "1" [x,y,z],x])),A (q [x,y])],
                      DJ [N (A (f [fApp "1" [x,y,z],y])),N (A (f [fApp "1" [x,y,z],x])),A (q [x,y])]])

test10 :: Test
test10 = formCase "cnf test 10"
                  (((q [skY [x],skZ [x],skT [x]]) .|. ((p [x,skY [x]]))) .&. ((((.~.) (r [skY [x]])) .|. ((p [x,skY [x]])))))
                  (cnf' (for_all [x'] (exists [y'] ((p [x, y] .<=. for_all [x'] (exists [t'] (q [y, x, t]) .=>. r [y]))))))
    where
      t' = fromString "t"
      t = var t'
      p = pApp "p"
      q = pApp "q"
      r = pApp "r"
      skY = fApp "1"
      skZ = fApp "2"
      skT = fApp "3"

test11 :: Test
test11 = formCase "cnf test 11"
                  -- This one didn't come with a solution - here's ours
                  ((((.~.) (p [x,z])) .|. ((.~.) (q [x,skY [x,z]]))) .&. (((.~.) (p [x,z])) .|. (r [skY [x,z],z])))
                  (cnf' (for_all [x'] (for_all [z'] (p [x, z] .=>. exists [y'] ((.~.) (q [x, y] .|. ((.~.) (r [y, z]))))))))
    where
      p = pApp "p"
      q = pApp "q"
      r = pApp "r"
      skY = fApp "1"

test12 :: Test
test12 = formCase "cnf test 12"
                  (((p.|.(r.|.s)).&.(((.~.) q).|.(r.|.s))).&.((p.|.(r.|.t)).&.(((.~.) q).|.(r.|.t))))
                  (cnf' ((p .=>. q) .=>. (((.~.) r) .=>. (s .&. t))))
    where
      [p, q, r, s, t] = map (\ s -> pApp s []) ["p", "q", "r", "s", "t"]

moveQuantifiersOut1 :: Test
moveQuantifiersOut1 =
    formCase "moveQuantifiersOut1"
             (for_all [y'] (pApp (fromString "p") [y] .&. (pApp (fromString "q") [x])))
             (prenexNormalForm (for_all [x'] (pApp (fromString "p") [x]) .&. (pApp (fromString "q") [x])))

skolemize1 :: Test
skolemize1 =
    formCase "skolemize1" expected formula
    where
      expected :: TestFormula
      expected = for_all [y',z'] (for_all [v'] (pApp "P" [fApp ("1") [], y, z, fApp ("2") [y, z], v, fApp "3" [y, z, v]]))
      formula :: TestFormula
      formula = (snf' (exists [x'] (for_all [y', z'] (exists [u'] (for_all [v'] (exists [w'] (pApp "P" [x, y, z, u, v, w])))))))

skolemize2 :: Test
skolemize2 =
    formCase "skolemize2" expected formula
    where
      expected :: TestFormula
      expected = for_all [fromString "y"] (pApp ("loves") [fApp ("1") [],y])
      formula :: TestFormula
      formula = snf' (exists [x'] (for_all [y'] (pApp "loves" [x, y])))

skolemize3 :: Test
skolemize3 =
    formCase "skolemize3" expected formula
    where
      expected :: TestFormula
      expected = for_all [fromString "y"] (pApp ("loves") [fApp ("1") [y],y])
      formula :: TestFormula
      formula = snf' (for_all [y'] (exists [x'] (pApp "loves" [x, y])))

theoremTests :: [Test]
theoremTests =
    let s = pApp "S"
        h = pApp "H"
        m = pApp "M" in
    [ let formula = for_all [x'] (((s [x] .=>. h [x]) .&. (h [x] .=>. m [x])) .=>.
                                  (s [x] .=>. m [x])) in
      TestCase (assertEqual "theorem test 1"
                (True,
                 ["+--------------------------+--------------------------+--------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","| (pApp (\"H\") [var (\"x\")]) | (pApp (\"M\") [var (\"x\")]) | (pApp (\"S\") [var (\"x\")]) | [[[[(pApp (\"S\") [var (\"x\")]) + (pApp (\"H\") [var (\"x\")])] + [-(pApp (\"S\") [var (\"x\")]) + (pApp (\"M\") [var (\"x\")])]] * [[-(pApp (\"H\") [var (\"x\")]) + (pApp (\"H\") [var (\"x\")])] + [-(pApp (\"S\") [var (\"x\")]) + (pApp (\"M\") [var (\"x\")])]]] * [[[(pApp (\"S\") [var (\"x\")]) + -(pApp (\"M\") [var (\"x\")])] + [-(pApp (\"S\") [var (\"x\")]) + (pApp (\"M\") [var (\"x\")])]] * [[-(pApp (\"H\") [var (\"x\")]) + -(pApp (\"M\") [var (\"x\")])] + [-(pApp (\"S\") [var (\"x\")]) + (pApp (\"M\") [var (\"x\")])]]]] |","+--------------------------+--------------------------+--------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            0             |                                                                                                                                                                                                                                          1                                                                                                                                                                                                                                          |","+--------------------------+--------------------------+--------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            1             |                                                                                                                                                                                                                                          1                                                                                                                                                                                                                                          |","+--------------------------+--------------------------+--------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            0             |                                                                                                                                                                                                                                          1                                                                                                                                                                                                                                          |","+--------------------------+--------------------------+--------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            1             |                                                                                                                                                                                                                                          1                                                                                                                                                                                                                                          |","+--------------------------+--------------------------+--------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            0             |                                                                                                                                                                                                                                          1                                                                                                                                                                                                                                          |","+--------------------------+--------------------------+--------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            1             |                                                                                                                                                                                                                                          1                                                                                                                                                                                                                                          |","+--------------------------+--------------------------+--------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            0             |                                                                                                                                                                                                                                          1                                                                                                                                                                                                                                          |","+--------------------------+--------------------------+--------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            1             |                                                                                                                                                                                                                                          1                                                                                                                                                                                                                                          |","+--------------------------+--------------------------+--------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"])
                (theorem' formula, table' formula))
    , TestCase (assertEqual "theorem test 1a"
{-
input:               ((.~.) ((for_all [x'] (((S [x]) .=>. ((H [x]))) .&. (((H [x]) .=>. ((M [x])))))) .=>. ((for_all [x'] ((S [x]) .=>. ((M [x])))))))

simplified:          ((.~.) (((.~.) (for_all [x'] ((((.~.) (S [x])) .|. ((H [x]))) .&. ((((.~.) (H [x])) .|. ((M [x]))))))) .|. ((for_all [x'] (((.~.) (S [x])) .|. ((M [x])))))))

moveNegationsIn:     ((for_all [x'] ((((.~.) (S [x])) .|. ((H [x]))) .&. ((((.~.) (H [x])) .|. ((M [x])))))) .&. ((exists [x'] ((S [x]) .&. (((.~.) (M [x])))))))

moveQuantifiersOut:  (for_all [x'] (exists [y'] (((((.~.) (S [x])) .|. ((H [x]))) .&. ((((.~.) (H [x])) .|. ((M [x]))))) .&. (((S [y]) .&. (((.~.) (M [y]))))))))

skolmize:            (((((.~.) (S [x])) .|. ((H [x]))) .&. ((((.~.) (H [x])) .|. ((M [x]))))) .&. (((S [fApp ("Sk(y)") [x]]) .&. (((.~.) (M [fApp ("Sk(y)") [x]]))))))

distributeDisjuncts: (((((.~.) (S [x])) .|. ((H [x]))) .&.
                       ((((.~.) (H [x])) .|. ((M [x]))))) .&.
                      (((S [fApp ("Sk(y)") [x]]) .&.
                        (((.~.) (M [fApp ("Sk(y)") [x]]))))))

distributeDisjuncts: (~S(x) | H(x)) & (~H(x) | M(x)) & S(SkY(x)) & ~M(SkY(x))
-}
                (False,
                 False,
                 ["+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","| (pApp (\"H\") [fApp (AtomicFunction \"1\") []]) | (pApp (\"M\") [fApp (AtomicFunction \"1\") []]) | (pApp (\"M\") [var (\"y\")]) | (pApp (\"S\") [fApp (AtomicFunction \"1\") []]) | (pApp (\"S\") [var (\"y\")]) | [[[[(pApp (\"S\") [fApp (AtomicFunction \"1\") []]) + (pApp (\"H\") [fApp (AtomicFunction \"1\") []])] + [-(pApp (\"S\") [var (\"y\")]) + (pApp (\"M\") [var (\"y\")])]] * [[-(pApp (\"H\") [fApp (AtomicFunction \"1\") []]) + (pApp (\"H\") [fApp (AtomicFunction \"1\") []])] + [-(pApp (\"S\") [var (\"y\")]) + (pApp (\"M\") [var (\"y\")])]]] * [[[(pApp (\"S\") [fApp (AtomicFunction \"1\") []]) + -(pApp (\"M\") [fApp (AtomicFunction \"1\") []])] + [-(pApp (\"S\") [var (\"y\")]) + (pApp (\"M\") [var (\"y\")])]] * [[-(pApp (\"H\") [fApp (AtomicFunction \"1\") []]) + -(pApp (\"M\") [fApp (AtomicFunction \"1\") []])] + [-(pApp (\"S\") [var (\"y\")]) + (pApp (\"M\") [var (\"y\")])]]]] |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |                      0                      |            0             |                      0                      |            0             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |                      0                      |            0             |                      0                      |            1             |                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |                      0                      |            0             |                      1                      |            0             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |                      0                      |            0             |                      1                      |            1             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |                      0                      |            1             |                      0                      |            0             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |                      0                      |            1             |                      0                      |            1             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |                      0                      |            1             |                      1                      |            0             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |                      0                      |            1             |                      1                      |            1             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |                      1                      |            0             |                      0                      |            0             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |                      1                      |            0             |                      0                      |            1             |                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |                      1                      |            0             |                      1                      |            0             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |                      1                      |            0             |                      1                      |            1             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |                      1                      |            1             |                      0                      |            0             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |                      1                      |            1             |                      0                      |            1             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |                      1                      |            1             |                      1                      |            0             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |                      1                      |            1             |                      1                      |            1             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |                      0                      |            0             |                      0                      |            0             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |                      0                      |            0             |                      0                      |            1             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |                      0                      |            0             |                      1                      |            0             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |                      0                      |            0             |                      1                      |            1             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |                      0                      |            1             |                      0                      |            0             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |                      0                      |            1             |                      0                      |            1             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |                      0                      |            1             |                      1                      |            0             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |                      0                      |            1             |                      1                      |            1             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |                      1                      |            0             |                      0                      |            0             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |                      1                      |            0             |                      0                      |            1             |                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |                      1                      |            0             |                      1                      |            0             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |                      1                      |            0             |                      1                      |            1             |                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |                      1                      |            1             |                      0                      |            0             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |                      1                      |            1             |                      0                      |            1             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |                      1                      |            1             |                      1                      |            0             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |                      1                      |            1             |                      1                      |            1             |                                                                                                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                      |","+---------------------------------------------+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"])
                
                (let formula = (for_all [x'] ((s [x] .=>. h [x]) .&. (h [x] .=>. m [x]))) .=>.
                               (for_all [x'] (s [x] .=>. m [x])) in
                 (theorem' formula, inconsistant' formula, table' formula)))
                
    , TestCase (assertEqual "socrates is mortal, truth table"
                (["+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","| (pApp (\"H\") [var (\"x\")]) | (pApp (\"H\") [var (\"y\")]) | (pApp (\"M\") [var (\"y\")]) | (pApp (\"M\") [var (\"z\")]) | (pApp (\"S\") [var (\"x\")]) | (pApp (\"S\") [var (\"z\")]) | [[[-(pApp (\"S\") [var (\"x\")]) + (pApp (\"H\") [var (\"x\")])] * [-(pApp (\"H\") [var (\"y\")]) + (pApp (\"M\") [var (\"y\")])]] * [-(pApp (\"S\") [var (\"z\")]) + (pApp (\"M\") [var (\"z\")])]] |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            0             |            0             |            0             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            0             |            0             |            0             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            0             |            0             |            1             |            0             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            0             |            0             |            1             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            0             |            1             |            0             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            0             |            1             |            0             |            1             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            0             |            1             |            1             |            0             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            0             |            1             |            1             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            1             |            0             |            0             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            1             |            0             |            0             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            1             |            0             |            1             |            0             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            1             |            0             |            1             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            1             |            1             |            0             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            1             |            1             |            0             |            1             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            1             |            1             |            1             |            0             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |            1             |            1             |            1             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            0             |            0             |            0             |            0             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            0             |            0             |            0             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            0             |            0             |            1             |            0             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            0             |            0             |            1             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            0             |            1             |            0             |            0             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            0             |            1             |            0             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            0             |            1             |            1             |            0             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            0             |            1             |            1             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            1             |            0             |            0             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            1             |            0             |            0             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            1             |            0             |            1             |            0             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            1             |            0             |            1             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            1             |            1             |            0             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            1             |            1             |            0             |            1             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            1             |            1             |            1             |            0             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |            1             |            1             |            1             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            0             |            0             |            0             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            0             |            0             |            0             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            0             |            0             |            1             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            0             |            0             |            1             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            0             |            1             |            0             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            0             |            1             |            0             |            1             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            0             |            1             |            1             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            0             |            1             |            1             |            1             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            1             |            0             |            0             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            1             |            0             |            0             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            1             |            0             |            1             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            1             |            0             |            1             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            1             |            1             |            0             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            1             |            1             |            0             |            1             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            1             |            1             |            1             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |            1             |            1             |            1             |            1             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            0             |            0             |            0             |            0             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            0             |            0             |            0             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            0             |            0             |            1             |            0             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            0             |            0             |            1             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            0             |            1             |            0             |            0             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            0             |            1             |            0             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            0             |            1             |            1             |            0             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            0             |            1             |            1             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            1             |            0             |            0             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            1             |            0             |            0             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            1             |            0             |            1             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            1             |            0             |            1             |            1             |                                                                                      0                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            1             |            1             |            0             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            1             |            1             |            0             |            1             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            1             |            1             |            1             |            0             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |            1             |            1             |            1             |            1             |                                                                                      1                                                                                       |","+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"])
                -- This formula has separate variables for each of the
                -- three beliefs.  To combine these into an argument
                -- we would wrap a single exists around them all and
                -- remove the existing ones, substituting that one
                -- variable into each formula.
                (table' (for_all [x'] (s [x] .=>. h [x]) .&.
                         for_all [y'] (h [y] .=>. m [y]) .&.
                         for_all [z'] (s [z] .=>. m [z]))))

    , TestCase (assertEqual "socrates is not mortal"
                (False,
                 False,
                 ["+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","| (pApp (\"H\") [var (\"x\")]) | (pApp (\"M\") [var (\"x\")]) | (pApp (\"S\") [fApp (AtomicFunction \"socrates\") []]) | (pApp (\"S\") [var (\"x\")]) | [[[[-(pApp (\"S\") [var (\"x\")]) + (pApp (\"H\") [var (\"x\")])] * [-(pApp (\"H\") [var (\"x\")]) + (pApp (\"M\") [var (\"x\")])]] * [-(pApp (\"M\") [var (\"x\")]) + -(pApp (\"S\") [var (\"x\")])]] * (pApp (\"S\") [fApp (AtomicFunction \"socrates\") []])] |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |                         0                          |            0             |                                                                                                                  0                                                                                                                   |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |                         0                          |            1             |                                                                                                                  0                                                                                                                   |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |                         1                          |            0             |                                                                                                                  1                                                                                                                   |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            0             |                         1                          |            1             |                                                                                                                  0                                                                                                                   |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |                         0                          |            0             |                                                                                                                  0                                                                                                                   |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |                         0                          |            1             |                                                                                                                  0                                                                                                                   |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |                         1                          |            0             |                                                                                                                  1                                                                                                                   |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            0             |            1             |                         1                          |            1             |                                                                                                                  0                                                                                                                   |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |                         0                          |            0             |                                                                                                                  0                                                                                                                   |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |                         0                          |            1             |                                                                                                                  0                                                                                                                   |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |                         1                          |            0             |                                                                                                                  0                                                                                                                   |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            0             |                         1                          |            1             |                                                                                                                  0                                                                                                                   |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |                         0                          |            0             |                                                                                                                  0                                                                                                                   |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |                         0                          |            1             |                                                                                                                  0                                                                                                                   |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |                         1                          |            0             |                                                                                                                  1                                                                                                                   |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|            1             |            1             |                         1                          |            1             |                                                                                                                  0                                                                                                                   |","+--------------------------+--------------------------+----------------------------------------------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"],
                 (for_all [fromString "x"]
                  ((((((.~.) (pApp ("S") [var (fromString "x")])) .|. ((pApp ("H") [var (fromString "x")]))) .&.
                     ((((.~.) (pApp ("H") [var (fromString "x")])) .|. ((pApp ("M") [var (fromString "x")]))))) .&.
                    ((((.~.) (pApp ("M") [var (fromString "x")])) .|. (((.~.) (pApp ("S") [var (fromString "x")])))))) .&.
                   ((pApp ("S") [fApp ("socrates") []])))))
                -- This represents a list of beliefs like those in our
                -- database: socrates is a man, all men are mortal,
                -- each with its own quantified variable.  In
                -- addition, we have an inconsistant belief, socrates
                -- is not mortal.  If we had a single variable this
                -- would be inconsistant, but as it stands it is an
                -- invalid argument, there are both 0 and 1 lines in
                -- the truth table.  If we go through the table and
                -- eliminate the lines where S(SkZ(x,y)) is true but M(SkZ(x,y)) is
                -- false (for any x) and those where H(x) is true but
                -- M(x) is false, the remaining lines would all be zero,
                -- the argument would be inconsistant (an anti-theorem.)
                -- How can we modify the formula to make these lines 0?
                (let formula =
                         for_all [x'] ((s [x] .=>. h [x]) .&.
                                       (h [x] .=>. m [x]) .&.
                                       (m [x] .=>. ((.~.) (s [x])))) .&.
                         (s [fApp "socrates" []]) in
                 (theorem' formula, inconsistant' formula, table' formula, disjunctiveNormalForm formula)))
    , let formula = (for_all [fromString "x"] (pApp "L" [var (fromString "x")] .=>. pApp "F" [var (fromString "x")]) .&. -- All logicians are funny
                     exists [fromString "x"] (pApp "L" [var (fromString "x")])) .=>.                            -- Someone is a logician
                    (.~.) (exists [fromString "x"] (pApp "F" [var (fromString "x")]))                           -- Someone / Nobody is funny
          input = table' formula
          expected = ["+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","| (pApp (\"F\") [fApp (AtomicFunction \"1\") []]) | (pApp (\"F\") [var (\"z\")]) | (pApp (\"L\") [fApp (AtomicFunction \"1\") []]) | (pApp (\"L\") [var (\"y\")]) | [[[(pApp (\"L\") [fApp (AtomicFunction \"1\") []]) + -(pApp (\"L\") [var (\"y\")])] + -(pApp (\"F\") [var (\"z\")])] * [[-(pApp (\"F\") [fApp (AtomicFunction \"1\") []]) + -(pApp (\"L\") [var (\"y\")])] + -(pApp (\"F\") [var (\"z\")])]] |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |            0             |                      0                      |            0             |                                                                                                          1                                                                                                           |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |            0             |                      0                      |            1             |                                                                                                          1                                                                                                           |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |            0             |                      1                      |            0             |                                                                                                          1                                                                                                           |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |            0             |                      1                      |            1             |                                                                                                          1                                                                                                           |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |            1             |                      0                      |            0             |                                                                                                          1                                                                                                           |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |            1             |                      0                      |            1             |                                                                                                          0                                                                                                           |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |            1             |                      1                      |            0             |                                                                                                          1                                                                                                           |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      0                      |            1             |                      1                      |            1             |                                                                                                          1                                                                                                           |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |            0             |                      0                      |            0             |                                                                                                          1                                                                                                           |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |            0             |                      0                      |            1             |                                                                                                          1                                                                                                           |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |            0             |                      1                      |            0             |                                                                                                          1                                                                                                           |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |            0             |                      1                      |            1             |                                                                                                          1                                                                                                           |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |            1             |                      0                      |            0             |                                                                                                          1                                                                                                           |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |            1             |                      0                      |            1             |                                                                                                          0                                                                                                           |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |            1             |                      1                      |            0             |                                                                                                          1                                                                                                           |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+","|                      1                      |            1             |                      1                      |            1             |                                                                                                          0                                                                                                           |","+---------------------------------------------+--------------------------+---------------------------------------------+--------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"]
      in TestCase (assertEqual "gensler189" expected input)
    ]

{-
theorem5 =
    TestCase (assertEqual "theorm test 2"
              (Just True)
              (theorem ((.~.) ((for_all [x'] (((s [x] .=>. h [x]) .&.
                                               (h [x] .=>. m [x]))) .&.
                                exists [x'] (s [x] .&.
                                             ((.~.) (m [x]))))))))
-}

instance TD.Display (TestFormula) where
    textFrame x = [showForm x]
{-
    textFrame x = [quickShow x]
        where
          quickShow =
              foldF (\ _ -> error "Expecting atoms")
                    (\ _ _ _ -> error "Expecting atoms")
                    (\ _ _ _ -> error "Expecting atoms")
                    (\ t1 op t2 -> quickShowTerm t1 ++ quickShowOp op ++ quickShowTerm t2)
                    (\ p ts -> quickShowPred p ++ "(" ++ intercalate "," (map quickShowTerm ts) ++ ")")
          quickShowTerm =
              foldT quickShowVar
                    (\ f ts -> quickShowFn f ++ "(" ++ intercalate "," (map quickShowTerm ts) ++ ")")
          quickShowVar v = show v
          quickShowPred s = s
          quickShowFn (AtomicFunction s) = s
          quickShowOp (:=:) = "="
          quickShowOp (:!=:) = "!="
-}

{-
-- Truth table tests, find a more reasonable result value than [String].

(theorem1a, theorem1b, theorem1c, theorem1d) =
    ( TestCase (assertEqual "truth table 1"
                (Just ["foo"])
                (prepare (for_all [x'] (((s [x] .=>. h [x]) .&. (h [x] .=>. m [x])) .=>. (s [x] .=>. m [x]))) >>=
                 return . TD.textFrame . truthTable)) )
    where s = pApp "S"
          h = pApp "H"
          m = pApp "M"

type FormulaPF = Formula String String
type F = PropForm FormulaPF

prepare :: FormulaPF -> F
prepare formula = ({- flatten . -} fromJust . toPropositional convertA . cnf . (.~.) $ formula)

convertA = Just . A
-}

table :: (PredicateLogic formula term v p f, Show formula, Ord formula, Eq term, Skolem m f, TD.Display formula) =>
         formula -> m TD.TextFrame
table f = clauses f >>= return . TD.textFrame . truthTable
